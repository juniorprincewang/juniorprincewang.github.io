<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"juniorprincewang.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.18.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本篇博客介绍shell脚本的语法知识。更多Bash使用请参考Bash Reference Manual。">
<meta property="og:type" content="article">
<meta property="og:title" content="shell脚本编程简介">
<meta property="og:url" content="http://juniorprincewang.github.io/2018/04/16/shellscripts/index.html">
<meta property="og:site_name" content="TO DO">
<meta property="og:description" content="本篇博客介绍shell脚本的语法知识。更多Bash使用请参考Bash Reference Manual。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-04-16T01:43:08.000Z">
<meta property="article:modified_time" content="2022-10-13T12:10:46.905Z">
<meta property="article:author" content="Max">
<meta property="article:tag" content="shell">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://juniorprincewang.github.io/2018/04/16/shellscripts/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://juniorprincewang.github.io/2018/04/16/shellscripts/","path":"2018/04/16/shellscripts/","title":"shell脚本编程简介"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>shell脚本编程简介 | TO DO</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="/custom_css_source.css">
<!-- hexo injector head_end end --><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">TO DO</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">吾尝终日而思矣，不如须臾之所学也。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A%E5%99%A8"><span class="nav-number">1.</span> <span class="nav-text">解释器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%98%E9%87%8F"><span class="nav-number">2.</span> <span class="nav-text">变量</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="nav-number">2.1.</span> <span class="nav-text">定义变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E7%BB%84"><span class="nav-number">2.2.</span> <span class="nav-text">数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F"><span class="nav-number">2.3.</span> <span class="nav-text">使用变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8D%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="nav-number">2.4.</span> <span class="nav-text">重定义变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E6%B5%8B%E8%AF%95%E5%92%8C%E5%86%85%E5%AE%B9%E6%9B%BF%E6%8D%A2"><span class="nav-number">2.5.</span> <span class="nav-text">变量的测试和内容替换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F"><span class="nav-number">2.6.</span> <span class="nav-text">特殊变量</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%84%9A%E6%9C%AC%E4%BC%A0%E5%8F%82"><span class="nav-number">2.6.1.</span> <span class="nav-text">脚本传参</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shift-n"><span class="nav-number">2.6.2.</span> <span class="nav-text">shift [n]</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B3%A8%E9%87%8A"><span class="nav-number">3.</span> <span class="nav-text">注释</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">4.</span> <span class="nav-text">字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7"><span class="nav-number">4.1.</span> <span class="nav-text">单引号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8C%E5%BC%95%E5%8F%B7"><span class="nav-number">4.2.</span> <span class="nav-text">双引号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="nav-number">4.3.</span> <span class="nav-text">字符串操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%BC%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">4.3.1.</span> <span class="nav-text">拼接字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6"><span class="nav-number">4.3.2.</span> <span class="nav-text">获取字符串长度：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E5%8F%96%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">4.3.3.</span> <span class="nav-text">提取子字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9B%BF%E6%8D%A2"><span class="nav-number">4.3.4.</span> <span class="nav-text">子字符串替换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%B4%E5%A4%9A"><span class="nav-number">4.4.</span> <span class="nav-text">更多</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95"><span class="nav-number">5.</span> <span class="nav-text">测试</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="nav-number">6.</span> <span class="nav-text">条件判断</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="nav-number">6.1.</span> <span class="nav-text">流程控制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#if-else"><span class="nav-number">6.2.</span> <span class="nav-text">if else</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#if"><span class="nav-number">6.2.1.</span> <span class="nav-text">if</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#if-else-1"><span class="nav-number">6.2.2.</span> <span class="nav-text">if else</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#if-else-if-else"><span class="nav-number">6.2.3.</span> <span class="nav-text">if else-if else</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#for-while"><span class="nav-number">6.3.</span> <span class="nav-text">for while</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#for"><span class="nav-number">6.3.1.</span> <span class="nav-text">for</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c%E9%A3%8E%E6%A0%BC%E7%9A%84for"><span class="nav-number">6.3.2.</span> <span class="nav-text">C风格的for</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#while"><span class="nav-number">6.3.3.</span> <span class="nav-text">while</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF"><span class="nav-number">6.3.4.</span> <span class="nav-text">无限循环</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%92%8C"><span class="nav-number">6.4.</span> <span class="nav-text">&amp;&amp; 和 ||</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="nav-number">7.</span> <span class="nav-text">文件包含</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E8%BE%93%E5%85%A5"><span class="nav-number">8.</span> <span class="nav-text">用户输入</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E6%97%B6%E4%BC%A0%E5%85%A5"><span class="nav-number">8.1.</span> <span class="nav-text">执行脚本时传入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%84%9A%E6%9C%AC%E8%BF%90%E8%A1%8C%E4%B8%AD%E8%BE%93%E5%85%A5"><span class="nav-number">8.2.</span> <span class="nav-text">脚本运行中输入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#select%E8%8F%9C%E5%8D%95"><span class="nav-number">8.3.</span> <span class="nav-text">select菜单</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#stdinstdout%E5%92%8Cstderr"><span class="nav-number">9.</span> <span class="nav-text">stdin、stdout和stderr</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="nav-number">10.</span> <span class="nav-text">常用的命令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ps"><span class="nav-number">10.1.</span> <span class="nav-text">ps</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#grep"><span class="nav-number">10.2.</span> <span class="nav-text">grep</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E9%99%A4grep%E8%87%AA%E8%BA%AB"><span class="nav-number">10.2.1.</span> <span class="nav-text">排除grep自身</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E4%B8%8Etarget%E7%9B%B8%E9%82%BB%E7%9A%84%E7%BB%93%E6%9E%9C"><span class="nav-number">10.2.2.</span> <span class="nav-text">查找与target相邻的结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sed"><span class="nav-number">10.3.</span> <span class="nav-text">sed</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#awk"><span class="nav-number">10.4.</span> <span class="nav-text">awk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xargs"><span class="nav-number">10.5.</span> <span class="nav-text">xargs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#curl"><span class="nav-number">10.6.</span> <span class="nav-text">curl</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E6%88%98"><span class="nav-number">11.</span> <span class="nav-text">实战</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#makefile-%E4%B8%AD%E5%88%A4%E6%96%AD%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="nav-number">12.</span> <span class="nav-text">Makefile
中判断一个文件是否存在</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">13.</span> <span class="nav-text">参考</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Max</p>
  <div class="site-description" itemprop="description">文章本天成，妙手偶得之。</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">92</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">97</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/juniorprincewang" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;juniorprincewang" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:maxzywang@163.com" title="E-Mail → mailto:maxzywang@163.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://juniorprincewang.github.io/2018/04/16/shellscripts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Max">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TO DO">
      <meta itemprop="description" content="文章本天成，妙手偶得之。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="shell脚本编程简介 | TO DO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          shell脚本编程简介
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-04-16 09:43:08" itemprop="dateCreated datePublished" datetime="2018-04-16T09:43:08+08:00">2018-04-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-10-13 20:10:46" itemprop="dateModified" datetime="2022-10-13T20:10:46+08:00">2022-10-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/linux/shell/" itemprop="url" rel="index"><span itemprop="name">shell</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>本篇博客介绍shell脚本的语法知识。更多Bash使用请参考<a
target="_blank" rel="noopener" href="https://www.gnu.org/software/bash/manual/bash.html">Bash Reference
Manual</a>。</p>
<span id="more"></span>
<h1 id="解释器">解释器</h1>
<p>第一行一般是这样：</p>
<pre><code>#!/bin/bash
#!/usr/bin/php</code></pre>
<p><code>#!</code>
是一个约定的标记，它告诉系统这个脚本需要什么解释器来执行。</p>
<h1 id="变量">变量</h1>
<h2 id="定义变量">定义变量</h2>
<p>定义变量时，变量名不加美元符号 <code>$</code>，如：</p>
<pre><code>your_name=&quot;test&quot;</code></pre>
<p>注意，<strong>变量名和等号之间不能有空格</strong>。</p>
<p>除了显式地直接赋值，还可以用语句给变量赋值，如：</p>
<pre><code>for file in `ls /etc`</code></pre>
<h2 id="数组">数组</h2>
<ol type="1">
<li><p>声明数组<br />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">declare -a array</span><br></pre></td></tr></table></figure></p></li>
<li><p>直接定义</p></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(1) array=(var1 var2 var3 ... varN)</span><br><span class="line">(2) array=([0]=var1 [1]=var2 [2]=var3 ... [n]=varN)</span><br><span class="line">(3) array[0]=var1</span><br><span class="line">    arrya[1]=var2</span><br><span class="line">    ...</span><br><span class="line">    array[n]=varN</span><br></pre></td></tr></table></figure>
<p>使用数组：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$&#123;array[i]&#125;                     # 引用数组</span><br><span class="line">$&#123;array[*]&#125; 或$&#123;array[@]&#125;       # 数组所有成员</span><br><span class="line">$&#123;!array[*]&#125; 或$&#123;!array[@]&#125;     # 数组所有下标</span><br><span class="line">$&#123;#array[*]&#125; 或$&#123;#array[@]&#125;     # 数组元素个数</span><br><span class="line">$&#123;#array[0]&#125;                    # 数组第一个成员的长度</span><br></pre></td></tr></table></figure>
<p>比如：<br />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">COLOR=(&quot;red&quot; &quot;green&quot; &quot;yellow&quot; &quot;blue&quot; [5]=&quot;orange&quot;)</span><br><span class="line">echo $&#123;#COLOR[*]&#125;</span><br><span class="line">&gt; 5</span><br><span class="line"></span><br><span class="line">echo $&#123;!COLOR[*]&#125;</span><br><span class="line">&gt; 0 1 2 3 5</span><br><span class="line"></span><br><span class="line">for item in $&#123;COLOR[*]&#125;</span><br><span class="line">do</span><br><span class="line">    printf &quot;   %s/n&quot; $item</span><br><span class="line">done</span><br></pre></td></tr></table></figure></p>
<p><a
target="_blank" rel="noopener" href="https://blog.csdn.net/ilovemilk/java/article/details/4959747"
class="uri">https://blog.csdn.net/ilovemilk/java/article/details/4959747</a></p>
<h2 id="使用变量">使用变量</h2>
<p>使用一个定义过的变量，只要在变量名前面加美元符号 <code>$</code>
即可，如： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">your_name=&quot;test&quot;</span><br><span class="line">echo $your_name</span><br><span class="line">echo $&#123;your_name&#125;</span><br></pre></td></tr></table></figure>
变量名外面的花括号是可选的，加不加都行，加花括号是为了帮助解释器识别变量的边界，比如下面这种情况：
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for skill in Python C Shell Java; do</span><br><span class="line">	echo &quot;I am good at $&#123;skill&#125;Script&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure> 如果不给 <code>skill</code> 变量加花括号，写成
<code>echo "I am good at $skillScript"</code> ，解释器就会把
<code>$skillScript</code>
当成一个变量（其值为空），代码执行结果就不是我们期望的样子了。</p>
<p>推荐给所有变量加上花括号，这是个好的编程习惯。</p>
<h2 id="重定义变量">重定义变量</h2>
<p>已定义的变量，可以被重新定义，如： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">your_name=&quot;test&quot;</span><br><span class="line">echo $your_name</span><br><span class="line"></span><br><span class="line">your_name=&quot;foo&quot;</span><br><span class="line">echo $your_name</span><br></pre></td></tr></table></figure>
这样写是合法的，但注意，第二次赋值的时候不能写
<code>$your_name="foo"</code> ，使用变量的时候才加美元符。</p>
<h2 id="变量的测试和内容替换">变量的测试和内容替换</h2>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>变量配置方式</th>
<th>str 没有配置</th>
<th>str 为空字符串</th>
<th>str 已配置非为空字符串</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>var=$&#123;str-expr&#125;</code></td>
<td><code>var=expr</code></td>
<td><code>var=</code></td>
<td><code>var=$str</code></td>
</tr>
<tr class="even">
<td><code>var=$&#123;str:-expr&#125;</code></td>
<td><code>var=expr</code></td>
<td><code>var=expr</code></td>
<td><code>var=$str</code></td>
</tr>
<tr class="odd">
<td><code>var=$&#123;str+expr&#125;</code></td>
<td><code>var=</code></td>
<td><code>var=expr</code></td>
<td><code>var=expr</code></td>
</tr>
<tr class="even">
<td><code>var=$&#123;str:+expr&#125;</code></td>
<td><code>var=</code></td>
<td><code>var=</code></td>
<td><code>var=expr</code></td>
</tr>
<tr class="odd">
<td><code>var=$&#123;str=expr&#125;</code></td>
<td><code>str=expr</code> <code>var=expr</code></td>
<td>str 不变 var=</td>
<td>str 不变 <code>var=$str</code></td>
</tr>
<tr class="even">
<td><code>var=$&#123;str:=expr&#125;</code></td>
<td><code>str=expr</code> <code>var=expr</code></td>
<td><code>str=expr</code> <code>var=expr</code></td>
<td>str 不变 <code>var=$str</code></td>
</tr>
<tr class="odd">
<td><code>var=$&#123;str?expr&#125;</code></td>
<td>expr 输出至 stderr</td>
<td>var=</td>
<td><code>var=$str</code></td>
</tr>
<tr class="even">
<td><code>var=$&#123;str:?expr&#125;</code></td>
<td>expr 输出至 stderr</td>
<td>expr 输出至 stderr</td>
<td><code>var=$str</code></td>
</tr>
</tbody>
</table>
<p>说明：冒号的作用是，被测试的变量未被配置或者是已被配置为空字符串时，都能够用后面的内容来替换与配置。</p>
<p><a
target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_basic/0320bash.php">变量的测试与内容替换</a></p>
<h2 id="特殊变量">特殊变量</h2>
<ul>
<li><code>$0</code> - Bash 脚本的名字.</li>
<li><code>$1</code> - <code>$9</code> - 传入 Bash
脚本的第1个到第9个参数.</li>
<li><code>$#</code> - 传入 Bash 脚本的参数个数.</li>
<li><code>$*</code> - 传入 Bash 脚本所有参数.</li>
<li><code>$@</code> - 传递给脚本或函数的所有参数。被双引号("
")包含时，与 $* 稍有不同。</li>
<li><code>$?</code> - 上个命令的退出状态，或函数的返回值.</li>
<li><code>$$</code> - 当前Shell进程ID。对于 Shell
脚本，就是这些脚本所在的进程ID。<br />
</li>
<li><code>$USER</code> - The username of the user running the
script.</li>
<li><code>$HOSTNAME</code> - The hostname of the machine the script is
running on.</li>
<li><code>$SECONDS</code> - The number of seconds since the script was
started.</li>
<li><code>$RANDOM</code> - Returns a different random number each time
is it referred to.</li>
<li><code>$LINENO</code> - Returns the current line number in the Bash
script.</li>
</ul>
<h3 id="脚本传参">脚本传参</h3>
<p><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/a/31419">How can I pass a
command line argument into a shell script?</a><br />
"<code>$0</code>" 为脚本名称。<br />
"<code>$1</code>", "<code>$2</code>",
"<code>$3</code>"等分别为第1、第2、第3个参数。<br />
<code>$#</code> 为参数数量。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;First arg: $1&quot;</span><br></pre></td></tr></table></figure>
<p>help 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">helpFunction()</span><br><span class="line">&#123;</span><br><span class="line">   echo &quot;&quot;</span><br><span class="line">   echo &quot;Usage: $0 -a parameterA -b parameterB -c parameterC&quot;</span><br><span class="line">   echo -e &quot;\t-a Description of what is parameterA&quot;</span><br><span class="line">   echo -e &quot;\t-b Description of what is parameterB&quot;</span><br><span class="line">   echo -e &quot;\t-c Description of what is parameterC&quot;</span><br><span class="line">   exit 1 # Exit script after printing help</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if [ -z &quot;$1&quot; ] || [ -z &quot;$2&quot; ]</span><br><span class="line">then</span><br><span class="line">   helpFunction</span><br><span class="line">fi</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="shift-n"><code>shift [n]</code></h3>
<p><code>shift</code>
命令用于对参数左移n个位置，同时左边被覆盖的参数都被销毁，默认n为1。
比如： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">while [ $# != 0 ];do</span><br><span class="line">	echo &quot;第一个参数为：$1,参数个数为：$#&quot;</span><br><span class="line">	shift</span><br><span class="line">done</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>run.sh a b c d e f</p>
</blockquote>
<pre><code>第一个参数为：a,参数个数为：6
第一个参数为：b,参数个数为：5
第一个参数为：c,参数个数为：4
第一个参数为：d,参数个数为：3
第一个参数为：e,参数个数为：2
第一个参数为：f,参数个数为：1</code></pre>
<h1 id="注释">注释</h1>
<p><code>BASH</code> 文件，单行注释用 <code>#</code> ，多行注释可以用
<code>&lt;&lt;COMMENT ……   COMMENT</code> 来包裹需要注释的命令行。
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;COMMENT</span><br><span class="line"></span><br><span class="line">something else.</span><br><span class="line"></span><br><span class="line">COMMENT</span><br></pre></td></tr></table></figure></p>
<h1 id="字符串">字符串</h1>
<p>字符串是 <code>shell</code>
编程中最常用最有用的数据类型，字符串可以用单引号，也可以用双引号，也可以不用引号。单双引号的区别跟PHP类似。</p>
<h2 id="单引号">单引号</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str=&#x27;this is a string&#x27;</span><br></pre></td></tr></table></figure>
<p>单引号字符串的限制：</p>
<ul>
<li>单引号里的任何字符都会原样输出，单引号字符串中的变量是无效的</li>
<li>单引号字串中不能出现单引号（对单引号使用转义符后也不行）</li>
</ul>
<h2 id="双引号">双引号</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">your_name=&#x27;test&#x27;</span><br><span class="line">str=&quot;Hello, I know your are \&quot;$your_name\&quot;! \n&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li>双引号里可以有变量</li>
<li>双引号里可以出现转义字符</li>
</ul>
<h2 id="字符串操作">字符串操作</h2>
<h3 id="拼接字符串">拼接字符串</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">your_name=&quot;test&quot;</span><br><span class="line">greeting=&quot;hello, &quot;$your_name&quot; !&quot;</span><br><span class="line">greeting_1=&quot;hello, $&#123;your_name&#125; !&quot;</span><br><span class="line"></span><br><span class="line">echo $greeting $greeting_1</span><br></pre></td></tr></table></figure>
<h3 id="获取字符串长度">获取字符串长度：</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string=&quot;abcd&quot;</span><br><span class="line">echo $&#123;#string&#125; #输出：4</span><br></pre></td></tr></table></figure>
<h3 id="提取子字符串">提取子字符串</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string=&quot;foos bar&quot;</span><br><span class="line">echo $&#123;string:1:3&#125; #输出：foo</span><br></pre></td></tr></table></figure>
<h3 id="子字符串替换">子字符串替换</h3>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>format</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>$&#123;变量#关键词&#125;</code></td>
<td>若变量内容从头开始的数据符合『关键词』，则将符合的<strong>最短</strong>数据删除</td>
</tr>
<tr class="even">
<td><code>$&#123;变量##关键词&#125;</code></td>
<td>若变量内容从头开始的数据符合『关键词』，则将符合的<strong>最长</strong>数据删除</td>
</tr>
<tr class="odd">
<td><code>$&#123;变量%关键词&#125;</code></td>
<td>若变量内容从尾向前的数据符合『关键词』，则将符合的<strong>最短</strong>数据删除</td>
</tr>
<tr class="even">
<td><code>$&#123;变量%%关键词&#125;</code></td>
<td>若变量内容从尾向前的数据符合『关键词』，则将符合的<strong>最长</strong>数据删除</td>
</tr>
<tr class="odd">
<td><code>$&#123;变量/旧字符串/新字符串&#125;</code></td>
<td>若变量内容符合『旧字符串』则『<strong>第一个</strong>旧字符串会被新字符串取代』</td>
</tr>
<tr class="even">
<td><code>$&#123;变量//旧字符串/新字符串&#125;</code></td>
<td>若变量内容符合『旧字符串』则『<strong>全部</strong>的旧字符串会被新字符串取代』</td>
</tr>
</tbody>
</table>
<p>例子： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[centos ~]# x=&quot;a1 b1 c2 d2&quot;</span><br><span class="line">[centos ~]# echo $&#123;x&#125;</span><br><span class="line">a1 b1 c2 d2</span><br><span class="line">[centos ~]# echo $&#123;x#*1&#125;</span><br><span class="line">b1 c2 d2</span><br><span class="line">[centos ~]# echo $&#123;x##*1&#125;</span><br><span class="line">c2 d2</span><br><span class="line">[centos ~]# echo $&#123;x%1*&#125;</span><br><span class="line">a1 b</span><br><span class="line">[centos ~]# echo $&#123;x%%1*&#125;</span><br><span class="line">a</span><br><span class="line">[centos ~]# echo $&#123;x/1/3&#125;</span><br><span class="line">a3 b1 c2 d2</span><br><span class="line">[centos ~]# echo $&#123;x//1/3&#125;</span><br><span class="line">a3 b3 c2 d2</span><br><span class="line">[centos ~]# echo $&#123;x//?1/z3&#125;</span><br><span class="line">z3 z3 c2 d2</span><br><span class="line">[centos ~]# basename /usr/bin</span><br><span class="line">bin</span><br><span class="line">[centos ~]# dirname /usr/bin</span><br><span class="line">/usr</span><br></pre></td></tr></table></figure></p>
<p><a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/2059794/what-is-the-meaning-of-the-0-syntax-with-variable-braces-and-hash-chara">What
is the meaning of the ${0##...} syntax with variable, braces and hash
character in bash?</a><br />
<a
target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_basic/0320bash.php">变量内容的删除、取代与替换</a></p>
<h2 id="更多">更多</h2>
<p>参见本文档末尾的参考资料中<a
target="_blank" rel="noopener" href="http://tldp.org/LDP/abs/html/string-manipulation.html">Advanced
Bash-Scripting Guid Chapter 10.1</a></p>
<h1 id="测试">测试</h1>
<p>内置命令 test 根据表达式expr 求值的结果返回 <code>0（真）</code> 或
<code>1（假）</code> 。 也可以使用方括号： <code>test expr</code> 和
<code>[ expr ]</code> 是等价的。 可以用 <code>$?</code>
检查返回值；可以使用 <code>&amp;&amp;</code> 和 <code>||</code>
操作返回值；也可以用后面介绍的各种条件结构测试返回值。</p>
<p>常见的测试命令选项：</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>操作符</th>
<th>特征</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>! EXPRESSION</td>
<td>EXPRESSION 条件为假</td>
</tr>
<tr class="even">
<td>EXPRESSION1 <strong><code>-a</code></strong> EXPRESSION2</td>
<td>EXPRESSION1 与 EXPRESSION2 都为 true，此处 <code>a</code> 为and</td>
</tr>
<tr class="odd">
<td>EXPRESSION1 <strong><code>-o</code></strong> EXPRESSION2</td>
<td>EXPRESSION1 或者 EXPRESSION2 为 true，此处 <code>o</code> 为or</td>
</tr>
<tr class="even">
<td>-n STRING</td>
<td>STRING 长度大于0</td>
</tr>
<tr class="odd">
<td>-z STRING</td>
<td>STRING 长度为0</td>
</tr>
<tr class="even">
<td>STRING1 = STRING2</td>
<td>STRING1 与 STRING2 字符串相同</td>
</tr>
<tr class="odd">
<td>STRING1 != STRING2</td>
<td>STRING1 与 STRING2 字符串不同</td>
</tr>
<tr class="even">
<td>INTEGER1 <strong><code>-eq</code></strong> INTEGER2</td>
<td>INTEGER1 数值上与 INTEGER2相等，equal</td>
</tr>
<tr class="odd">
<td>INTEGER1 <strong><code>-ge</code></strong> INTEGER2</td>
<td>INTEGER1 数值上比 INTEGER2 大或相等， greater than or equal to</td>
</tr>
<tr class="even">
<td>INTEGER1 <strong><code>-gt</code></strong> INTEGER2</td>
<td>INTEGER1 数值上比 INTEGER2 大， greater than</td>
</tr>
<tr class="odd">
<td>INTEGER1 <strong><code>-le</code></strong> INTEGER2</td>
<td>INTEGER1 数值上比 INTEGER2 小或相等， less than or equal to</td>
</tr>
<tr class="even">
<td>INTEGER1 <strong><code>-lt</code></strong> INTEGER2</td>
<td>INTEGER1 数值上比 INTEGER2 小，less than</td>
</tr>
<tr class="odd">
<td>INTEGER1 <strong><code>-ne</code></strong> INTEGER2</td>
<td>INTEGER1 数值上比 INTEGER2 不相等，not equal to</td>
</tr>
<tr class="even">
<td>FILE1 <strong><code>-ef</code></strong> FILE2</td>
<td>FILE1 与 FILE2 有相同的 device 和 inode numbers</td>
</tr>
<tr class="odd">
<td>FILE1 <strong><code>-nt</code></strong> FILE2</td>
<td>FILE1 与 FILE2 相比更新（modification date），newer than</td>
</tr>
<tr class="even">
<td>FILE1 <strong><code>-ot</code></strong> FILE2</td>
<td>FILE1 与 FILE2 相比更旧，older than</td>
</tr>
<tr class="odd">
<td>-b FILE</td>
<td>FILE 存在并且是block文件</td>
</tr>
<tr class="even">
<td>-c FILE</td>
<td>FILE 存在并且是character文件</td>
</tr>
<tr class="odd">
<td>-d FILE</td>
<td>FILE 目录存在</td>
</tr>
<tr class="even">
<td>-e FILE</td>
<td>FILE 存在.</td>
</tr>
<tr class="odd">
<td>-r FILE</td>
<td>FILE 存在并且可读.</td>
</tr>
<tr class="even">
<td>-s FILE</td>
<td>FILE 存在并且非空.</td>
</tr>
<tr class="odd">
<td>-w FILE</td>
<td>FILE 存在并且可写.</td>
</tr>
<tr class="even">
<td>-x FILE</td>
<td>FILE 存在并且可执行.</td>
</tr>
<tr class="odd">
<td>-f FILE</td>
<td>FILE普通文件</td>
</tr>
<tr class="even">
<td>-h FILE</td>
<td>FILE符号连接（也可以用 -L）</td>
</tr>
<tr class="odd">
<td>-p FILE</td>
<td>FILE命名管道</td>
</tr>
<tr class="even">
<td>-S FILE</td>
<td>FILE套接字</td>
</tr>
<tr class="odd">
<td>-N FILE</td>
<td>FILE从上次读取之后已经做过修改</td>
</tr>
</tbody>
</table>
<p>需要注意的是 <code>=</code> 与 <code>-eq</code> 略有不同，
<code>=</code> 作字符串比较， <code>-eq</code> 作数值比较。
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@PowerEdge-R610:~/tools# test 001 = 1</span><br><span class="line">root@PowerEdge-R610:~/tools# echo $?</span><br><span class="line">1</span><br><span class="line">root@PowerEdge-R610:~/tools# test 001 -eq 1</span><br><span class="line">root@PowerEdge-R610:~/tools# echo $?</span><br><span class="line">0</span><br></pre></td></tr></table></figure></p>
<h1 id="条件判断">条件判断</h1>
<h2 id="流程控制">流程控制</h2>
<p>和Java、PHP等语言不一样，<code>bash</code> 的流程控制不可为空，如：
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if (isset($_GET[&quot;q&quot;])) &#123;</span><br><span class="line">	search(q);</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">	//do nothing</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 在 <code>bash shell</code>
里可不能这么写，如果else分支没有语句执行，就不要写这个else。</p>
<p>还要注意，<code>BASH</code> 里的
<code>if [ $foo -eq 0 ]</code>，这个方括号跟 <code>Java/PHP</code> 里
<code>if</code> 后面的圆括号大不相同，它是一个可执行程序（和
<code>ls</code> , <code>grep</code> 一样），想不到吧？在CentOS上，它在
<code>/usr/bin</code> 目录下： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ll /usr/bin/[</span><br><span class="line">-rwxr-xr-x. 1 root root 33408 4月  16 2018 /usr/bin/[</span><br></pre></td></tr></table></figure>
正因为方括号在这里是一个可执行程序，方括号后面必须加空格，不能写成
<code>if [$foo -eq 0]</code>。</p>
<h2 id="if-else">if else</h2>
<h3 id="if">if</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if condition</span><br><span class="line">then</span><br><span class="line">	command1 </span><br><span class="line">	command2</span><br><span class="line">	...</span><br><span class="line">	commandN </span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<p>写成一行（适用于终端命令提示符）：</p>
<pre><code>if `ps -ef | grep ssh`;  then echo hello; fi</code></pre>
<p>末尾的fi就是if倒过来拼写，后面还会遇到类似的</p>
<h3 id="if-else-1">if else</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if condition</span><br><span class="line">then</span><br><span class="line">	command1 </span><br><span class="line">	command2</span><br><span class="line">	...</span><br><span class="line">	commandN</span><br><span class="line">else</span><br><span class="line">	command</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<h3 id="if-else-if-else">if else-if else</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if condition1</span><br><span class="line">then</span><br><span class="line">	command1</span><br><span class="line">elif condition2</span><br><span class="line">	command2</span><br><span class="line">else</span><br><span class="line">	commandN</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<h2 id="for-while">for while</h2>
<h3 id="for">for</h3>
<p>在开篇的示例里演示过了： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for var in item1 item2 ... itemN</span><br><span class="line">do</span><br><span class="line">	command1</span><br><span class="line">	command2</span><br><span class="line">	...</span><br><span class="line">	commandN</span><br><span class="line">done</span><br></pre></td></tr></table></figure> 写成一行： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for var in item1 item2 ... itemN; do command1; command2… done;</span><br></pre></td></tr></table></figure>
循环内部同样可以使用 <code>break</code> 、 <code>continue</code>
等命令。</p>
<h3 id="c风格的for">C风格的for</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for (( EXP1; EXP2; EXP3 ))</span><br><span class="line">do</span><br><span class="line">	command1</span><br><span class="line">	command2</span><br><span class="line">	command3</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h3 id="while">while</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while condition</span><br><span class="line">do</span><br><span class="line">	command</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h3 id="无限循环">无限循环</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while :</span><br><span class="line">do</span><br><span class="line">	command</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>或者 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while true</span><br><span class="line">do</span><br><span class="line">	command</span><br><span class="line">done</span><br></pre></td></tr></table></figure> 或者 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for (( ; ; ))</span><br></pre></td></tr></table></figure> ### until <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">until condition</span><br><span class="line">do</span><br><span class="line">	command</span><br><span class="line">done</span><br></pre></td></tr></table></figure> ##
case <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">case &quot;$&#123;opt&#125;&quot; in</span><br><span class="line">	&quot;Install-Puppet-Server&quot; )</span><br><span class="line">		install_master $1</span><br><span class="line">		exit</span><br><span class="line">	;;</span><br><span class="line"></span><br><span class="line">	&quot;Install-Puppet-Client&quot; )</span><br><span class="line">		install_client $1</span><br><span class="line">		exit</span><br><span class="line">	;;</span><br><span class="line"></span><br><span class="line">	&quot;Config-Puppet-Server&quot; )</span><br><span class="line">		config_puppet_master</span><br><span class="line">		exit</span><br><span class="line">	;;</span><br><span class="line"></span><br><span class="line">	&quot;Config-Puppet-Client&quot; )</span><br><span class="line">		config_puppet_client</span><br><span class="line">		exit</span><br><span class="line">	;;</span><br><span class="line"></span><br><span class="line">	&quot;Exit&quot; )</span><br><span class="line">		exit</span><br><span class="line">	;;</span><br><span class="line"></span><br><span class="line">	* ) echo &quot;Bad option, please choose again&quot;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure> <code>case</code> 的语法和C
family语言差别很大，它需要一个esac（就是case反过来）作为结束标记，每个case分支用右圆括号，用两个分号表示break</p>
<h2 id="和"><code>&amp;&amp;</code> 和 <code>||</code></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">if [ -r $1 ] &amp;&amp; [ -s $1 ]</span><br><span class="line">then</span><br><span class="line">	echo &quot;This file is useful.&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<h1 id="文件包含">文件包含</h1>
<p>可以使用source和.关键字，如： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source ./function.sh</span><br><span class="line">. ./function.sh</span><br></pre></td></tr></table></figure>
在bash里，<code>source</code> 和 <code>.</code> 是等效的，他们都是读入
<code>function.sh</code> 的内容并执行其内容（类似PHP里的
<code>include</code>），为了更好的可移植性，推荐使用第二种写法。</p>
<p>包含一个文件和执行一个文件一样，也要写这个文件的路径，不能光写文件名，比如上述例子中:
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. ./function.sh</span><br></pre></td></tr></table></figure> 不可以写作： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. function.sh</span><br></pre></td></tr></table></figure>
如果function.sh是用户传入的参数，如何获得它的绝对路径呢？方法是：
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">real_path=`readlink -f $1`#$1是用户输入的参数，如function.sh</span><br><span class="line">. $real_path</span><br></pre></td></tr></table></figure></p>
<h1 id="用户输入">用户输入</h1>
<h2 id="执行脚本时传入">执行脚本时传入</h2>
<h2 id="脚本运行中输入">脚本运行中输入</h2>
<h2 id="select菜单">select菜单</h2>
<h1 id="stdinstdout和stderr">stdin、stdout和stderr</h1>
<p>文件描述符0 代表 <code>stdin</code>，文件描述符1 代表
<code>stdout</code>，文件描述符2 代表 <code>stderr</code>。</p>
<p><code>&amp;</code> 指示后面是文件描述符，而不是文件名。因此，使用
<code>2&gt;&amp;1</code>，将<code>&gt;&amp;</code>视为重定向合并运算符。
而 <code>2&gt;1</code> 会将标准错误输出重定向到名为"1"的文件里。</p>
<p>而 <code>&amp;&gt;</code> 会将 <code>stdout</code> 与
<code>stderr</code> 都重定向到输出文件中。</p>
<p>比如 <code>command &amp;&gt;file</code> 也可以写成
<code>command &gt;file 2&gt;&amp;1</code>。</p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/a/818284">What does " 2&gt;&amp;1
" mean?</a></p>
<h1 id="常用的命令">常用的命令</h1>
<p>sh脚本结合系统命令便有了强大的威力，在字符处理领域，有grep、awk、sed三剑客，grep负责找出特定的行，awk能将行拆分成多个字段，sed则可以实现更新插入删除等写操作。</p>
<h2 id="ps">ps</h2>
<p>查看进程列表</p>
<h2 id="grep">grep</h2>
<h3 id="排除grep自身">排除grep自身</h3>
<h3 id="查找与target相邻的结果">查找与target相邻的结果</h3>
<h2 id="sed">sed</h2>
<h2 id="awk">awk</h2>
<p>awk 可对文本的每行进行查找、筛选和处理，是 grep、sed的集大成者。</p>
<p>awk 内置变量：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ARGC               命令行参数个数</span><br><span class="line">ARGV               命令行参数排列</span><br><span class="line">ENVIRON            支持队列中系统环境变量的使用</span><br><span class="line">FILENAME           awk浏览的文件名</span><br><span class="line">FNR                浏览文件的记录数</span><br><span class="line">FS                 设置输入域分隔符，等价于命令行 -F选项</span><br><span class="line">NF                 浏览记录的域的个数</span><br><span class="line">NR                 已读的记录数</span><br><span class="line">OFS                输出域分隔符</span><br><span class="line">ORS                输出记录分隔符</span><br><span class="line">RS                 控制记录分隔符</span><br></pre></td></tr></table></figure>
<p>此外, <code>$0</code> 变量是指整条记录， <code>$1</code>
表示当前行的第一个域, <code>$2</code>
表示当前行的第二个域,......以此类推。</p>
<p>awk中同时提供了<code>print</code> 和 <code>printf</code>
两种打印输出的函数。<br />
其中 <code>print</code>
的参数可以是变量、数值或者字符串。字符串必须用双引号引用，参数用逗号分隔。如果没有逗号，参数就串联在一起而无法区分。这里，逗号的作用与输出文件的分隔符的作用是一样的，只是后者是空格而已。<br />
<code>printf</code> 函数，可以格式化字符串，与C语言用法一致。</p>
<p>awk
的语法和C语言很相似，有变量和赋值、条件语句、循环语句、数组（字典）等，非常方便我们对搜索字段进行复杂处理。</p>
<p>比如，可以根据一个文件中的关键字去另一个文件筛选包含关键字的行。</p>
<p>a.txt<br />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">key1, value1</span><br><span class="line">key2, value2</span><br><span class="line">key3, value3</span><br><span class="line">key4, value4</span><br></pre></td></tr></table></figure></p>
<p>b.txt<br />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key2</span><br><span class="line">key4</span><br></pre></td></tr></table></figure></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F <span class="string">&#x27;[,]&#x27;</span> <span class="string">&#x27;NR==FNR&#123;a[$1]=$2;next&#125;NR!=FNR&#123;if($1 in a)print $0&quot;:&quot;a[$1]&#125;’ a.txt b.txt</span></span><br></pre></td></tr></table></figure>
<p>此命令的原理是： 先对a.txt 进行读取处理，再对 b.txt 读取处理。 NR
表示读取的所有行数， FNR 表示读取的当前文件的行数，所以
<code>NR==FNR</code> 表示开始读取的第一个文件，而 NR!=FNR
表示读取的第二个文件。<br />
对每行以 <code>,</code>
为分隔符进行分割处理。当处理第一个文件时，每行分割后的结果是
$1="key1"，但是 $2=" value1"，这里<strong>注意</strong>，<code>$2</code>
是包含前置空格的。这个有时候需要处理的。
我们定义了一个数组（这里是哈希数组），以 <code>$1</code> 为关键字，以
<code>$2</code> 为值进行存储，即a["key1"]=" value1"。 <code>next</code>
表示不进行对后面命令。
当处理第二个文件时，判断第二个文件的每行的第一个字段 <code>$1</code>
是否出现在前面生成的数组 <code>a</code> 的关键字中，如果出现，则打印以
key:value 形式打印。</p>
<p>可以对筛选到的文本进行变为大写字符操作：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123; print toupper($0) &#125;&#x27;</span> &lt;&lt;&lt; <span class="string">&quot;your string&quot;</span></span><br></pre></td></tr></table></figure>
<p>去除前后空格：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">awk -F, <span class="string">&#x27;/,/&#123;gsub(/ /, &quot;&quot;, $2); print$1&quot;,&quot;$2&#125; &#x27;</span> input.txt</span><br><span class="line"><span class="comment"># 更具体地 对前空格删除</span></span><br><span class="line">gsub(/^[ \t]+/,<span class="string">&quot;&quot;</span>,<span class="variable">$2</span>) </span><br><span class="line"><span class="comment"># 对后空格删除</span></span><br><span class="line">gsub(/[ \t]+$/,<span class="string">&quot;&quot;</span>,<span class="variable">$2</span>)&#125;</span><br></pre></td></tr></table></figure>
<p>可参考的资料：<br />
<a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/14984340/using-awk-to-process-input-from-multiple-files">Using
AWK to Process Input from Multiple Files</a><br />
<a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/32481877/what-are-nr-and-fnr-and-what-does-nr-fnr-imply">What
are NR and FNR and what does “NR==FNR” imply?</a><br />
<a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/12204192/using-multiple-delimiters-in-awk">Using
multiple delimiters in awk</a><br />
<a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/26746361/check-if-an-awk-array-contains-a-value">Check
if an awk array contains a value</a><br />
<a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/20600982/trim-leading-and-trailing-spaces-from-a-string-in-awk">Trim
leading and trailing spaces from a string in awk</a><br />
<a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/14021899/can-i-use-awk-to-convert-all-the-lower-case-letters-into-upper-case">Can
I use awk to convert all the lower-case letters into
upper-case?</a><br />
<a target="_blank" rel="noopener" href="https://backreference.org/2010/02/10/idiomatic-awk/">Idiomatic
awk</a><br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/luanjinlu/article/details/78122429">[awk
shell] 判断一个文件中内容在另一个文件中</a></p>
<h2 id="xargs">xargs</h2>
<h2 id="curl">curl</h2>
<h1 id="实战">实战</h1>
<ul>
<li>set environment variables in existing shell</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=&quot;/home/path/to/bin/:$PATH&quot;</span><br></pre></td></tr></table></figure>
<p>直接运行脚本只会在子进程 subshell
里面执行，不会对当前shell设置环境变量。</p>
<p>在当前shell中设置环境变量有两种办法： <code>source</code> or
<code>.</code> 。 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ./myscript.sh</span><br></pre></td></tr></table></figure> 或者 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. ./myscript.sh</span><br></pre></td></tr></table></figure></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/a/18548047">Shell script to set
environment variables</a></p>
<ul>
<li>单独以root执行某一命令</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo -u &lt;username&gt; &lt;command&gt;</span><br><span class="line">su &lt;otheruser&gt; -c &lt;command &gt;</span><br><span class="line"># 例如： su root -c &#x27;echo  &quot;hello from $USER&quot;&#x27;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/a/264239">How can I execute a
script as root, execute some commands in it as a specific user and just
one command as root</a><br />
<a
target="_blank" rel="noopener" href="https://askubuntu.com/questions/294736/run-a-shell-script-as-another-user-that-has-no-password">Run
a shell script as another user that has no password</a><br />
<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/10220200">How to write a shell
script that runs some commands as superuser and some commands not as
superuser, without having to babysit it?</a></p>
<ul>
<li>获得版本</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/a/6245903">Extract version number
from file in shell script</a></p>
<p>获得CUDA 版本号</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">version=<span class="string">&quot;<span class="subst">$(cat /usr/local/cuda/version.txt | head -n1|cut -d <span class="string">&quot; &quot;</span> -f3)</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$version</span></span><br><span class="line"></span><br><span class="line">majorminor=<span class="variable">$&#123;version%.*&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$majorminor</span></span><br></pre></td></tr></table></figure>
<ul>
<li>比较版本</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/a/285928">How to compare a
program's version in a shell script?</a> <a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/4023830/how-to-compare-two-strings-in-dot-separated-version-format-in-bash">How
to compare two strings in dot separated version format in Bash?</a></p>
<p>比较gcc得版本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">currentver=&quot;$(gcc -dumpversion)&quot;</span><br><span class="line">requiredver=&quot;5.0.0&quot;</span><br><span class="line"> if [ &quot;$(printf &#x27;%s\n&#x27; &quot;$requiredver&quot; &quot;$currentver&quot; | sort -V | head -n1)&quot; = &quot;$requiredver&quot; ]; then </span><br><span class="line">        echo &quot;Greater than or equal to 5.0.0&quot;</span><br><span class="line"> else</span><br><span class="line">        echo &quot;Less than 5.0.0&quot;</span><br><span class="line"> fi</span><br></pre></td></tr></table></figure>
<p>使用<a
target="_blank" rel="noopener" href="https://unix.stackexchange.com/users/135943/wildcard">通配符匹配</a></p>
<ul>
<li>判断文件是否存在</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/a/59839">Check if a directory
exists in a shell script</a><br />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if [ -d &quot;$DIRECTORY&quot; ]; then</span><br><span class="line">  # Control will enter here if $DIRECTORY exists.</span><br><span class="line">fi</span><br></pre></td></tr></table></figure></p>
<h1 id="makefile-中判断一个文件是否存在">Makefile
中判断一个文件是否存在</h1>
<p>Makefile中调用shell函数判断：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">exist = $(shell if [ -f $(FILE) ]; then echo &quot;exist&quot;; else echo &quot;notexist&quot;; fi;)</span><br><span class="line">ifeq (exist, &quot;exist&quot;)</span><br><span class="line">#do something here</span><br><span class="line">endif</span><br></pre></td></tr></table></figure>
<h1 id="参考">参考</h1>
<ul>
<li><a
target="_blank" rel="noopener" href="https://github.com/qinjx/30min_guides/blob/master/shell.md">Shell脚本编程30分钟入门</a></li>
<li><a target="_blank" rel="noopener" href="http://tldp.org/LDP/abs/html/">Advanced Bash-Scripting
Guide</a>，非常详细，非常易读，大量example，既可以当入门教材，也可以当做工具书查阅</li>
<li><a target="_blank" rel="noopener" href="http://www.tutorialspoint.com/unix/unix-shell.htm">Unix
Shell Programming</a></li>
<li><a target="_blank" rel="noopener" href="http://bash.cyberciti.biz/guide/Main_Page">Linux Shell
Scripting Tutorial - A Beginner's handbook</a></li>
<li><a
target="_blank" rel="noopener" href="https://ryanstutorials.net/bash-scripting-tutorial/bash-variables.php">Bash
Scripting Tutorial - 2. Variables</a></li>
<li><a
target="_blank" rel="noopener" href="https://ryanstutorials.net/bash-scripting-tutorial/bash-if-statements.php">Bash
Scripting Tutorial - 5. If Statements</a></li>
<li><a
target="_blank" rel="noopener" href="http://c.biancheng.net/cpp/view/2739.html">Shell特殊变量：Shell
$0, $#, $*, $@, $?, $$和命令行参数</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/shell/" rel="tag"># shell</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2018/04/13/kvm%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9/" rel="prev" title="kvm虚拟机磁盘扩容">
                  <i class="fa fa-angle-left"></i> kvm虚拟机磁盘扩容
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2018/04/18/%E5%AE%9E%E9%AA%8C%E5%90%A7-web-writeup/" rel="next" title="实验吧 web writeup">
                  实验吧 web writeup <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Max</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



</body>
</html>
